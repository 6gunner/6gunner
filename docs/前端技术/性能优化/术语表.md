## DCL

全称：document content loaded

## FCP

全称：first content paint

## LCP

全称：Largest Contentful Paint，指页面上最大的一块内容渲染出来的时间。

它可以衡量*加载*性能。目前是最合理的指标。

为了提供良好的用户体验，应在网页首次开始加载的 **2.5 秒**内完成 LCP。

**Q: 为什么不用loaded和`DocumentContentLoaded`?**

Loaded事件代表整个页面（所有的内容）都加载完毕的时间，但问题是，一个loading icon没加载出来可能也会认为内容没加载完；

DocumentContentLoaded代表HTML文档被完全加载和解析，但是问题是，它不包括样式，image的加载。所以这个时候用户看到的可能还是空白页面或者不完整的页面；

**Q: 如何优化LCP**

关注LCP，意味着更加关注用户的体验。因此优化LCP通常意味着:

- 优先加载viewport内的关键内容
- 延迟加载非关键资源
- 优化关键渲染路径
- 预加载重要资源

**Q: 怎么理解渐进式加载**

- 图片：优先加载一个LQIP（低质量图片占位符），然后再去在后台加载高质量的版本
- 代码split，对路由级别或者组件级别，进行按需加载

**Q: LCP是如何计算的？**

lcp是动态计算的，浏览器会监听viewport里添加的内容，计算他们加载的时间，更新LCP。

对于largest contentful比较就是width \* height

**Q: Devtool里的指标怎么看LCP**

在timeline里有一个LCP的竖线，点击可以看到对应的timestamp和相关的dom node。

<img src="https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-10/image-20250310113048570.png" alt="image-20250310113048570" style={{ zoom: '50%' }} />

参考：https://web.dev/lcp/#what-is-lcp

## FPS

每秒帧数 低于60帧时，用户感觉卡顿。

performance界面上展示成红色时，就表示帧速率下降得太低，影响用户体验

![image-20250306111701610](https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-06/image-20250306111701610.png)

## CPU堆叠图

颜色对应的意思在下面的summary里有。

图是堆叠的，如果彩色部分占据了100%高度，代表cpu是满负荷的。

灰色代表了空闲的cpu时间；

![image-20250306112617563](https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-06/image-20250306112617563.png)

## FPS 计数器

按 Command+Shift+P（Mac），输入fps展示Frame Rate

![image-20250306211334751](https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-06/image-20250306211334751.png)

## **Long Tasks（长任务）概念**

![image-20250307105534657](https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-07/image-20250307105534657.png)

### 长任务会有什么影响？

主线程一次只能处理一个任务

浏览器有一个Main thread，主线程一次只能处理一个任务；

任何用时超过 50 毫秒的任务都是*长任务*。

在任何长度的任务运行期间，浏览器都会阻止发生互动，如果有许多耗时任务正在运行，用户就会感觉页面无法点动；

如果主线程被阻塞很长时间，界面甚至可能会崩溃。

### 阻塞时段

对于超过 50 毫秒的任务，任务的总时间减去 50 毫秒称为任务的阻塞时段

### 任务的拆分

将大的任务拆分成小任务的好处是，浏览器可以在每一个小任务结束的时候，处理优先级更高的事件，比如用户的交互。

从而避免用户感觉卡顿

<img src="https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-07/a-depiction-how-breaking-999bc2dd02872.png" alt="一张图片，展示了拆分任务如何促进用户互动。在顶部，长任务会阻止事件处理脚本运行，直到任务完成。在底部，分块任务允许事件处理程序比以往更快地运行。" style={{ zoom: '50%' }} />

## INP

全称：interaction to next pain 从互动开始到下一个帧完全呈现所用的时间

含义：

INP大，代表可能有 long task影响了页面的渲染，给用户一种点不动的感觉；

- INP 低于或等于 **200 毫秒**表示网页**响应速度良好**。
- 如果 INP 高于 **200 毫秒**，但低于或等于 **500 毫秒**，则表示网页的响应能力**需要改进**。
- INP 超过 **500 毫秒**表示网页**响应速度缓慢**。

### VSync

**全称**：vertical synchronized 指的是 当前帧结束绘制，准备开始绘制下一帧时的信号。

vsync signal是由硬件设备发出的。

**渲染循环：**

- display设备通知vsync signal
- frame start，
- appliaction处理event
- gpu渲染frame
- 被渲染好的frame在队列里等待下一个vsync signal
- 设备处理上一个渲染好的frame

## Rasterization

**全称**： 光栅化

把屏幕想象成一个个小的方块组成，一个像素就是一个小方块。 一个矢量图需要转化成 `像素点阵`，从而显示出来。

![image-20250318151510462](https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-18/image-20250318151510462.png)

**Compositor 图层合成**

![image-20250318152823887](https://ipic-coda-hz.oss-cn-hangzhou.aliyuncs.com/2025-03-18/image-20250318152823887.png)
