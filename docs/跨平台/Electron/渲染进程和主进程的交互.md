
## 核心文件说明

### main.js（主进程）

```javascript
const { app, BrowserWindow } = require('electron');
const path = require('path');

function createWindow() {
  const mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js'),
      contextIsolation: true,
      enableRemoteModule: false,
      nodeIntegration: false
    }
  });

  mainWindow.loadFile('index.html');
}

app.whenReady().then(createWindow);
```

### preload.js（安全桥接）

```javascript
const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('electronAPI', {
  openFile: () => ipcRenderer.invoke('dialog:openFile'),
  saveFile: (data) => ipcRenderer.invoke('dialog:saveFile', data),
  onMenuClick: (callback) => ipcRenderer.on('menu-click', callback)
});
```




### 渲染进程 JS 文件❌不能直接使用 Node.js API

```javascript
// renderer.js - 这些都不能直接使用
const fs = require('fs');           // ❌ 文件系统
const path = require('path');       // ❌ 路径操作
const { spawn } = require('child_process'); // ❌ 子进程
const os = require('os');          // ❌ 操作系统信息

// ❌ 不能直接访问 Electron API
const { ipcRenderer } = require('electron'); // ❌ 直接引入
```


### 只能使用浏览器 API


```javascript
// renderer.js - 这些可以使用
console.log('Hello World');
fetch('/api/data');
localStorage.setItem('key', 'value');
document.getElementById('app');
window.location.href;

// Web APIs
navigator.geolocation.getCurrentPosition();
new WebSocket('ws://localhost:8080');
```


**注意：如果想要增加渲染进程的处理能力，需要通过 Preload 脚本安全地暴露 API**

### preload.js（桥接脚本）

```javascript
// preload.js - 在独立上下文中运行
const { contextBridge, ipcRenderer } = require('electron');
const fs = require('fs');

// 安全地暴露 API 给渲染进程
contextBridge.exposeInMainWorld('electronAPI', {
  // 文件操作
  readFile: async (filePath) => {
    return await fs.promises.readFile(filePath, 'utf8');
  },
  
  // IPC 通信
  sendMessage: (message) => ipcRenderer.send('message', message),
  onReply: (callback) => ipcRenderer.on('reply', callback),
  
  // 系统信息
  getPlatform: () => process.platform,
  getVersion: () => process.versions.electron
});
```

### 渲染进程中使用exposeInMainWorld暴露的api

```javascript
// renderer.js - 通过 window.electronAPI 使用
document.getElementById('readBtn').addEventListener('click', async () => {
  try {
    const content = await window.electronAPI.readFile('./data.txt');
    console.log(content);
  } catch (error) {
    console.error('读取文件失败:', error);
  }
});

// 发送消息到主进程
window.electronAPI.sendMessage('Hello from renderer');

// 监听主进程回复
window.electronAPI.onReply((event, data) => {
  console.log('收到主进程回复:', data);
});
```
